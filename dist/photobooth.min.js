"use strict";angular.module("ng-photobooth",[]).provider("photobooth",function(){var a,b=/^data:image\/(png|gif|jpe?g);base64,(.*)$/;this.setPostUrl=function(b){a=b},this.$get=["$http",function(c){return{saveDataUrl:function(d){var e=d.match(b);if(!e)throw new Error("Cannot save non-image data");return c.post(a,{image:e[2],ext:e[1]})}}}]}),angular.module("ng-photobooth").directive("photoButton",function(){var a="is-active";return function(b,c,d){c.bind("click",function(){b.$emit(b.camera?"photobooth:capture":"photobooth:start",b.camera)}),b.$on("photobooth:cameraStart",function(e,f){b.camera=f,c.addClass(d.startClass||a)}),b.$on("photobooth:cameraStop",function(){delete b.camera,c.removeClass(d.startClass||a)})}}),angular.module("ng-photobooth").directive("photoPreview",["webcam",function(a){return function(b,c,d){function e(){c.addClass(d.cameraOnClass||"is-active"),b.$emit("photobooth:cameraStart",c.find("video")[0])}function f(a){b.$emit("photobooth:cameraError",a)}b.$on("photobooth:start",function(){c.html("<video autoplay></video><canvas></canvas>"),a.start(c.find("video")[0],e,f)}),b.$on("photobooth:capture",function(){a.capture(c.find("video")[0],c.find("canvas")[0],d.previewType||"image/png")})}}]),angular.module("ng-photobooth").service("webcam",["photobooth",function(a){return{start:function(a,b,c){navigator.getUserMedia({video:!0,audio:!1},function(c){a.src=window.URL.createObjectURL(c),b(c)},c)},capture:function(b,c,d){return c.width=b.width,c.height=b.height,c.getContext("2d").drawImage(b,0,0),a.saveDataUrl(c.toDataURL(d))}}}]).run(function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia});